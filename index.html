<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>XRPCash - Instant Cashback Platform</title>
    <link rel="stylesheet" href="style.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xrpl/2.7.0/xrpl-latest.min.js"></script>
</head>
<body>
    <!-- Landing Page for Role Selection -->
    <div id="landingPage" class="landing-container">
        <div class="landing-header">
            <h1>🚀 XRPCash</h1>
            <div class="landing-tagline">Instant Cashback Rewards on the XRP Ledger</div>
            
            <div class="differentiator">
                <h3 style="margin-bottom: 20px; color: white;">Revolutionary Speed Comparison</h3>
                <div class="comparison">
                    <div class="old-way">
                        <h4>❌ Traditional Cashback</h4>
                        <p><strong>30-90 Days</strong><br>Bank transfers, processing delays</p>
                    </div>
                    <div class="new-way">
                        <h4>✅ XRPCash Platform</h4>
                        <p><strong>3-5 Seconds</strong><br>Instant blockchain payouts</p>
                    </div>
                </div>
            </div>
        </div>

        <div class="role-selection">
            <h2 style="text-align: center; color: white; margin-bottom: 40px;">Choose Your Role</h2>
            <div class="role-cards">
                <div class="role-card shopper-card" onclick="selectRole('shopper')">
                    <div class="role-icon">🛍️</div>
                    <h3>I'm a Buyer</h3>
                    <p>Browse products and earn instant XRP cashback on every purchase quickly</p>
                    <div class="role-features">
                        <div class="feature">✓ Instant XRP rewards</div>
                        <div class="feature">✓ Real-time transactions</div>
                        <div class="feature">✓ Personal cashback history</div>
                        <br>
                    </div>
                    <button class="role-btn">Start Shopping</button>
                </div>

                <div class="role-card merchant-card" onclick="selectRole('merchant')">
                    <div class="role-icon">🏪</div>
                    <h3>I'm a Merchant</h3>
                    <p>Manage your store with time-locked escrow accounts and automated commission handling</p>
                    <div class="role-features">
                        <div class="feature">✓ Time-locked escrow accounts</div>
                        <div class="feature">✓ Automated commission</div>
                        <div class="feature">✓ Secure fund management</div>
                    </div>
                    <button class="role-btn">Merchant Dashboard</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Shopper Experience -->
    <div id="shopperPage" class="page-content" style="display: none;">
        <div class="container">
            <div class="header">
                <div class="user-info">
                    <span class="user-role">👤 Shopper Mode</span>
                    <button class="switch-role-btn" onclick="showLanding()">Switch Role</button>
                </div>
                <h1>🚀 XRPCash</h1>
                <div class="tagline">Instant Cashback Rewards on the XRP Ledger</div>
            </div>

            <div class="main-content">
                <div class="product-section">
                    <h2>🛍️ Shop & Earn Instantly</h2>
                    
                    <!-- Product Grid -->
                    <div class="product-grid">
                        <div class="product-card" data-product="Nike Air Max 270" data-price="100.00" data-cashback="5">
                            <div class="product-image">👟</div>
                            <div class="product-title">Nike Air Max 270</div>
                            <div class="price">$100.00</div>
                            <div class="cashback-info">
                                <strong>💰 5% Cashback = $5 XRP</strong>
                            </div>
                            <button class="select-product-btn" onclick="selectProduct(this)">Select</button>
                        </div>

                        <div class="product-card" data-product="Apple AirPods Pro" data-price="249.00" data-cashback="8">
                            <div class="product-image">🎧</div>
                            <div class="product-title">Apple AirPods Pro</div>
                            <div class="price">$249.00</div>
                            <div class="cashback-info">
                                <strong>💰 8% Cashback = $19.92 XRP</strong>
                            </div>
                            <button class="select-product-btn" onclick="selectProduct(this)">Select</button>
                        </div>

                        <div class="product-card" data-product="Samsung Galaxy Watch" data-price="329.99" data-cashback="6">
                            <div class="product-image">⌚</div>
                            <div class="product-title">Samsung Galaxy Watch</div>
                            <div class="price">$329.99</div>
                            <div class="cashback-info">
                                <strong>💰 6% Cashback = $19.80 XRP</strong>
                            </div>
                            <button class="select-product-btn" onclick="selectProduct(this)">Select</button>
                        </div>

                        <div class="product-card" data-product="MacBook Air M2" data-price="1199.00" data-cashback="4">
                            <div class="product-image">💻</div>
                            <div class="product-title">MacBook Air M2</div>
                            <div class="price">$1,199.00</div>
                            <div class="cashback-info">
                                <strong>💰 4% Cashback = $47.96 XRP</strong>
                            </div>
                            <button class="select-product-btn" onclick="selectProduct(this)">Select</button>
                        </div>

                        <div class="product-card" data-product="Sony WH-1000XM5" data-price="399.99" data-cashback="7">
                            <div class="product-image">🎵</div>
                            <div class="product-title">Sony WH-1000XM5</div>
                            <div class="price">$399.99</div>
                            <div class="cashback-info">
                                <strong>💰 7% Cashback = $28.00 XRP</strong>
                            </div>
                            <button class="select-product-btn" onclick="selectProduct(this)">Select</button>
                        </div>

                        <div class="product-card" data-product="iPhone 15 Pro" data-price="999.00" data-cashback="3">
                            <div class="product-image">📱</div>
                            <div class="product-title">iPhone 15 Pro</div>
                            <div class="price">$999.00</div>
                            <div class="cashback-info">
                                <strong>💰 3% Cashback = $29.97 XRP</strong>
                            </div>
                            <button class="select-product-btn" onclick="selectProduct(this)">Select</button>
                        </div>

                        <div class="product-card" data-product="Nintendo Switch OLED" data-price="349.99" data-cashback="5">
                            <div class="product-image">🎮</div>
                            <div class="product-title">Nintendo Switch OLED</div>
                            <div class="price">$349.99</div>
                            <div class="cashback-info">
                                <strong>💰 5% Cashback = $17.50 XRP</strong>
                            </div>
                            <button class="select-product-btn" onclick="selectProduct(this)">Select</button>
                        </div>

                        <div class="product-card" data-product="Adidas Ultraboost 22" data-price="180.00" data-cashback="6">
                            <div class="product-image">👟</div>
                            <div class="product-title">Adidas Ultraboost 22</div>
                            <div class="price">$180.00</div>
                            <div class="cashback-info">
                                <strong>💰 6% Cashback = $10.80 XRP</strong>
                            </div>
                            <button class="select-product-btn" onclick="selectProduct(this)">Select</button>
                        </div>

                        <div class="product-card" data-product="Tesla Model Y Accessories" data-price="299.00" data-cashback="4">
                            <div class="product-image">🚗</div>
                            <div class="product-title">Tesla Model Y Accessories</div>
                            <div class="price">$299.00</div>
                            <div class="cashback-info">
                                <strong>💰 4% Cashback = $11.96 XRP</strong>
                            </div>
                            <button class="select-product-btn" onclick="selectProduct(this)">Select</button>
                        </div>
                    </div>

                    <!-- Selected Product Display -->
                    <div class="selected-product" id="selectedProduct" style="display: none;">
                        <h3>🛒 Selected Product</h3>
                        <div class="selected-item">
                            <span id="selectedName">Nike Air Max 270</span>
                            <span id="selectedPrice">$100.00</span>
                        </div>
                        <div class="selected-cashback" id="selectedCashback">
                            💰 Instant 5% Cashback = $5 XRP
                        </div>
                    </div>

                    <!-- Payment Form Section -->
                    <div class="payment-section">
                        <h3 style="margin-bottom: 20px; color: #333;">💳 Enter Payment Details</h3>
                        
                        <div class="order-summary" id="orderSummary" style="margin-bottom: 25px;">
                            <div class="summary-row">
                                <span id="orderProductName">Select a product</span>
                                <span id="orderProductPrice">$0.00</span>
                            </div>
                            <div class="summary-row">
                                <span>Tax</span>
                                <span id="orderTax">$0.00</span>
                            </div>
                            <div class="summary-row">
                                <span>Commission (2%)</span>
                                <span id="orderCommission">$0.00</span>
                            </div>
                            <div class="summary-row">
                                <span>Shipping</span>
                                <span>$5.99</span>
                            </div>
                            <div class="summary-row total">
                                <span>Total</span>
                                <span id="orderTotal">$5.99</span>
                            </div>
                        </div>

                        <form class="payment-form" id="paymentForm">
                            <div class="form-group">
                                <label for="cardNumber">Card Number</label>
                                <input type="text" id="cardNumber" placeholder="1234 5678 9012 3456" maxlength="19" required>
                                <div class="card-icons">
                                    <div class="card-icon">VISA</div>
                                    <div class="card-icon">MC</div>
                                    <div class="card-icon">AMEX</div>
                                </div>
                            </div>

                            <div class="form-row">
                                <div class="form-group">
                                    <label for="expiryDate">Expiry Date</label>
                                    <input type="text" id="expiryDate" placeholder="MM/YY" maxlength="5" required>
                                </div>
                                <div class="form-group">
                                    <label for="cvv">CVV</label>
                                    <input type="text" id="cvv" placeholder="123" maxlength="4" required>
                                </div>
                            </div>

                            <div class="form-group">
                                <label for="cardName">Cardholder Name</label>
                                <input type="text" id="cardName" placeholder="John Doe" required>
                            </div>

                            <button type="submit" class="btn" id="purchaseBtn" disabled>
                                🛒 Complete Purchase & Get Instant Cashback
                            </button>
                        </form>
                    </div>
                </div>

                <div class="wallet-section">
                    <h2>💳 XRP Wallet Setup</h2>
                    
                    <div class="wallet-form">
                        <div class="form-group">
                            <label for="walletAddress">Your XRP Wallet Address:</label>
                            <input 
                                type="text" 
                                id="walletAddress" 
                                placeholder="rN7n7otQDd6FczFgLdSqtcsAUxDkw6fzRH"
                                value="rN7n7otQDd6FczFgLdSqtcsAUxDkw6fzRH"
                            >
                        </div>
                        
                        <button class="btn" onclick="generateTestWallet()" id="generateBtn">
                            🎲 Generate Test Wallet
                        </button>
                        
                        <button class="btn" onclick="fundWallet()" id="fundBtn">
                            💧 Fund with Test XRP
                        </button>
                    </div>

                    <div class="cashback-highlight" style="margin-top: 20px;">
                        <strong>🎉 Earn instant XRP cashback on every purchase!</strong>
                        <div style="font-size: 0.9rem; margin-top: 5px;">
                            Cashback sent to your wallet within 3-5 seconds
                        </div>
                    </div>

                    <div class="commission-info" style="margin-top: 15px; padding: 15px; background: #f8f9fa; border-radius: 10px; border-left: 4px solid #667eea;">
                        <strong>ℹ️ Platform Commission</strong>
                        <div style="font-size: 0.9rem; margin-top: 5px; color: #666;">
                            2% commission automatically processed to platform wallet for each transaction
                        </div>
                    </div>

                    <div id="statusDisplay"></div>
                    <div id="transactionDetails"></div>
                </div>
            </div>

            <div class="history-section">
                <h2>📈 Your Cashback History</h2>
                <!-- This container will be populated by JavaScript after successful purchases -->
                <div id="cashbackHistory"></div>
            </div>
        </div>
    </div>

    <!-- Enhanced Merchant Experience with Escrow -->
    <div id="merchantPage" class="page-content" style="display: none;">
        <div class="container">
            <div class="header">
                <div class="user-info">
                    <span class="user-role">🏪 Merchant Mode</span>
                    <button class="switch-role-btn" onclick="showLanding()">Switch Role</button>
                </div>
                <h1>🚀 XRPCash Merchant Dashboard</h1>
                <div class="tagline">Manage Your Store with Time-Locked Escrow & Commission Processing</div>
            </div>

            <div class="merchant-dashboard">
                <div id="merchantStatusDisplay"></div>
                
                <div class="dashboard-grid">
                    <!-- Enhanced Escrow Management -->
                    <div class="dashboard-card escrow-card">
                        <h3>🔐 Time-Locked Escrow Account</h3>
                        
                        <div class="escrow-info">
                            <div class="metric">
                                <div class="metric-value" id="escrowBalance">0 XRP</div>
                                <div class="metric-label">Available Escrow Balance</div>
                            </div>
                            
                            <div class="escrow-details">
                                <div class="escrow-row">
                                    <span>Escrow Address:</span>
                                    <span id="escrowAddress" class="address-display">Not initialized</span>
                                </div>
                                <div class="escrow-row">
                                    <span>Lock Time Remaining:</span>
                                    <span id="escrowLockTime">Calculating...</span>
                                </div>
                            </div>
                            
                            <div id="escrowStatus" class="escrow-status">🔒 Initializing...</div>
                        </div>

                        <div class="escrow-actions">
                            <button class="btn" onclick="addFundsToEscrow()">
                                💰 Add Funds to Escrow
                            </button>
                            <button class="btn-secondary" onclick="withdrawFromEscrow()">
                                💸 Withdraw (When Unlocked)
                            </button>
                        </div>

                        <div class="escrow-explanation">
                            <h4>How Time-Locked Escrow Works:</h4>
                            <ul>
                                <li>🔒 Funds are locked for 24 hours after deposit</li>
                                <li>⏰ Provides security and prevents immediate withdrawals</li>
                                <li>💰 Cashback payments are deducted automatically</li>
                                <li>🔓 Withdraw remaining funds after lock period expires</li>
                            </ul>
                        </div>
                    </div>

                    <!-- Commission Account Overview -->
                    <div class="dashboard-card commission-card">
                        <h3>🏢 Commission Account</h3>
                        
                        <div class="commission-info">
                            <div class="metric">
                                <div class="metric-value">2.0%</div>
                                <div class="metric-label">Platform Commission Rate</div>
                            </div>
                            
                            <div class="commission-details">
                                <div class="commission-row">
                                    <span>Commission Wallet:</span>
                                    <span class="address-display">rCommissionWallet1234567890</span>
                                </div>
                                <div class="commission-row">
                                    <span>Auto-Processing:</span>
                                    <span class="status-indicator">✅ Enabled</span>
                                </div>
                            </div>
                        </div>

                        <div class="commission-explanation">
                            <h4>Commission Processing:</h4>
                            <ul>
                                <li>💼 2% of each sale goes to platform commission</li>
                                <li>⚡ Automatically processed with each transaction</li>
                                <li>📊 Transparent fee structure</li>
                                <li>🔄 Real-time commission distribution</li>
                            </ul>
                        </div>
                    </div>

                    <!-- Sales Overview -->
                    <div class="dashboard-card">
                        <h3>📊 Sales Overview</h3>
                        <div class="metric">
                            <div class="metric-value">$2,450.00</div>
                            <div class="metric-label">Total Sales Today</div>
                        </div>
                        <div class="metric">
                            <div class="metric-value">$122.50</div>
                            <div class="metric-label">Cashback Distributed</div>
                        </div>
                        <div class="metric">
                            <div class="metric-value">$49.00</div>
                            <div class="metric-label">Commission Processed</div>
                        </div>
                    </div>

                    <!-- Product Management -->
                    <div class="dashboard-card">
                        <h3>🛍️ Product Management</h3>
                        <div class="product-list" id="productList">
                            <div class="product-item">
                                <span>Nike Air Max 270</span>
                                <div class="cashback-rate">
                                    <label>Cashback: </label>
                                    <input type="number" value="5" min="0" max="20" onchange="updateCashbackRate(this, 'Nike Air Max 270')">%
                                </div>
                                <button class="delete-product-btn" onclick="deleteProduct(this, 'Nike Air Max 270')">🗑️</button>
                            </div>
                            <div class="product-item">
                                <span>Apple AirPods Pro</span>
                                <div class="cashback-rate">
                                    <label>Cashback: </label>
                                    <input type="number" value="8" min="0" max="20" onchange="updateCashbackRate(this, 'Apple AirPods Pro')">%
                                </div>
                                <button class="delete-product-btn" onclick="deleteProduct(this, 'Apple AirPods Pro')">🗑️</button>
                            </div>
                        </div>
                        
                        <!-- Add New Product Form -->
                        <div class="add-product-form" id="addProductForm" style="display: none;">
                            <div class="form-group">
                                <label for="productName">Product Name</label>
                                <input type="text" id="productName" placeholder="Enter product name" required>
                            </div>
                            <div class="form-group">
                                <label for="productPrice">Product Price ($)</label>
                                <input type="number" id="productPrice" placeholder="99.99" min="0" step="0.01" required>
                            </div>
                            <div class="form-group">
                                <label for="productCashback">Cashback Percentage (%)</label>
                                <input type="number" id="productCashback" placeholder="5" min="0" max="20" required>
                            </div>
                            <div class="form-actions">
                                <button class="btn" onclick="saveNewProduct()">✅ Save Product</button>
                                <button class="btn-secondary" onclick="cancelAddProduct()">❌ Cancel</button>
                            </div>
                        </div>
                        
                        <button class="btn-secondary" onclick="showAddProductForm()" id="addProductBtn">
                            ➕ Add New Product
                        </button>
                    </div>

                    <!-- Enhanced Payout History -->
                    <div class="dashboard-card">
                        <h3>📈 Transaction History</h3>
                        <div class="payout-history">
                            <div class="payout-item">
                                <div>
                                    <strong>Cashback Payment</strong>
                                    <div class="timestamp">Today, 2:30 PM</div>
                                    <div class="transaction-type">Nike Air Max 270</div>
                                </div>
                                <div class="amount negative">-$5.00 XRP</div>
                            </div>
                            <div class="payout-item">
                                <div>
                                    <strong>Commission Processed</strong>
                                    <div class="timestamp">Today, 2:30 PM</div>
                                    <div class="transaction-type">Platform Fee</div>
                                </div>
                                <div class="amount commission">$2.00 XRP</div>
                            </div>
                            <div class="payout-item">
                                <div>
                                    <strong>Escrow Deposit</strong>
                                    <div class="timestamp">Today, 1:15 PM</div>
                                    <div class="transaction-type">24h Lock Applied</div>
                                </div>
                                <div class="amount positive">+$100.00 XRP</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <script src="app.js"></script>
</body>
</html>